import{r as l,aw as y,j as e,B as X,ay as ee,aB as te,ax as be,f as C,aC as ye,aF as ke,av as fe}from"./index-Dd7dhgAO.js";import{g as U,c as L,b as E}from"./formatters-DuOnlAX0.js";import{F as I,p as je}from"./payoutService-fzfCuFgw.js";import{F as we}from"./AdjustmentsHorizontalIcon-D4oxg-w4.js";import{F as j}from"./ArrowPathIcon-BDzFR-8G.js";import{F as ae}from"./ClockIcon-DpHVzJ4M.js";import{F as M}from"./BanknotesIcon-9hj_nB3X.js";import{F as re}from"./DocumentDuplicateIcon-C46orym1.js";import{F as se}from"./CurrencyDollarIcon-DqON1HzM.js";import{F as ve}from"./MagnifyingGlassIcon-BjefptpO.js";import{F as Ne}from"./UsersIcon-DavD6FVP.js";function Se({title:a,titleId:n,...r},x){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:x,"aria-labelledby":n},r),a?l.createElement("title",{id:n},a):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 15.75 7.5-7.5 7.5 7.5"}))}const Ce=l.forwardRef(Se);function Te({title:a,titleId:n,...r},x){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:x,"aria-labelledby":n},r),a?l.createElement("title",{id:n},a):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 11.25v8.25a1.5 1.5 0 0 1-1.5 1.5H5.25a1.5 1.5 0 0 1-1.5-1.5v-8.25M12 4.875A2.625 2.625 0 1 0 9.375 7.5H12m0-2.625V7.5m0-2.625A2.625 2.625 0 1 1 14.625 7.5H12m0 0V21m-8.625-9.75h18c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125h-18c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z"}))}const Fe=l.forwardRef(Te),R={getTransactions:async(a={})=>(await y.get("/transactions",{params:a})).data,getTransactionById:async a=>(await y.get(`/transactions/${a}`)).data,reconcileTransaction:async a=>(await y.post(`/transactions/${a}/reconcile`)).data,batchReconcileTransactions:async(a=[])=>(await y.post("/transactions/batch-reconcile",{transactionIds:a})).data,getTransactionStats:async(a={})=>(await y.get("/transactions/stats",{params:a})).data,getPendingTransactions:async(a=50,n=24)=>(await y.get("/transactions/pending",{params:{limit:a,hours:n}})).data,exportTransactions:async(a={})=>await y.get("/transactions/export",{params:a,responseType:"blob"}),getTransactionSummary:async(a="month")=>(await y.get("/transactions/summary",{params:{period:a}})).data},O=({status:a})=>{const n={initiated:{color:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-300",text:"Initiated"},pending:{color:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-300",text:"Pending"},processing:{color:"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-300",text:"Processing"},completed:{color:"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300",text:"Successful"},failed:{color:"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-300",text:"Failed"},cancelled:{color:"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-300",text:"Cancelled"},expired:{color:"bg-orange-100 text-orange-800 dark:bg-orange-900/20 dark:text-orange-300",text:"Expired"},refunded:{color:"bg-purple-100 text-purple-800 dark:bg-purple-900/20 dark:text-purple-300",text:"Refunded"},reversed:{color:"bg-pink-100 text-pink-800 dark:bg-pink-900/20 dark:text-pink-300",text:"Reversed"}},r=n[a]||n.pending;return e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 md:px-3 md:py-1 rounded-full text-xs font-medium ${r.color}`,children:r.text})},W=({type:a})=>{const r={wallet_deposit:{color:"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-300",text:"Deposit",icon:I},wallet_withdrawal:{color:"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-300",text:"Withdrawal",icon:Ce},tournament_entry:{color:"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300",text:"Tournament",icon:Ne},prize_win:{color:"bg-purple-100 text-purple-800 dark:bg-purple-900/20 dark:text-purple-300",text:"Prize",icon:se},refund:{color:"bg-orange-100 text-orange-800 dark:bg-orange-900/20 dark:text-orange-300",text:"Refund",icon:j},bonus:{color:"bg-pink-100 text-pink-800 dark:bg-pink-900/20 dark:text-pink-300",text:"Bonus",icon:Fe}}[a]||{color:"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-300",text:a,icon:re},x=r.icon;return e.jsxs("span",{className:`inline-flex items-center px-1.5 py-0.5 md:px-2 md:py-1 rounded-md text-xs font-medium ${r.color}`,children:[e.jsx(x,{className:"h-3 w-3 mr-1"}),r.text]})},Re=({transaction:a,onReconcile:n,onCancel:r,onViewDetails:x,isReconciling:u,isSelected:g,onToggleSelect:w})=>{const{id:o,order_reference:d,type:m,amount:v,status:N,created_at:i,balance_before:$,balance_after:_,metadata:k}=a,S=["pending","processing","initiated"].includes(N),h=S&&new Date-new Date(i)>300*1e3,T=S&&m==="wallet_deposit",D=S&&m==="wallet_withdrawal";return e.jsx("div",{className:`bg-white dark:bg-neutral-800 rounded-lg border border-gray-200 dark:border-neutral-700 hover:border-gray-300 dark:hover:border-neutral-600 transition-colors ${g?"ring-2 ring-primary-500 dark:ring-primary-600":""}`,children:e.jsxs("div",{className:"p-3 md:p-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"md:hidden mr-2 mt-1",children:e.jsx("input",{type:"checkbox",checked:g,onChange:()=>w(o),className:"h-4 w-4 rounded border-gray-300 dark:border-neutral-600 bg-white dark:bg-neutral-700 text-primary-600 dark:text-primary-500 focus:ring-primary-500"})}),e.jsxs("div",{className:"flex items-start space-x-3 flex-1 min-w-0",children:[e.jsx("div",{className:`p-2 rounded-lg ${U(N)} flex-shrink-0`,children:e.jsx(M,{className:`h-5 w-5 ${L(N)}`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-1.5 mb-2",children:[e.jsx(W,{type:m}),e.jsx(O,{status:N}),h&&e.jsxs("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded-md text-xs font-medium bg-yellow-500/20 text-yellow-600 dark:text-yellow-400",children:[e.jsx(ee,{className:"h-3 w-3 mr-1"}),"Stuck"]})]}),e.jsxs("div",{className:"space-y-2 md:space-y-0 md:grid md:grid-cols-2 lg:grid-cols-3 gap-2 mb-2",children:[e.jsxs("div",{className:"truncate",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Reference"}),e.jsx("p",{className:"text-sm text-gray-900 dark:text-gray-900 dark:text-white font-mono truncate",children:d})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Amount"}),e.jsxs("p",{className:`text-base md:text-lg font-semibold ${v>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:[v>=0?"+":"",C(v,"USD")]})]}),e.jsxs("div",{className:"md:col-span-2 lg:col-span-1",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Date"}),e.jsx("p",{className:"text-sm text-gray-900 dark:text-gray-900 dark:text-white",children:E(i)})]})]}),k?.phone_number&&e.jsxs("div",{className:"mb-2",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Phone Number"}),e.jsx("p",{className:"text-sm text-gray-900 dark:text-gray-900 dark:text-white",children:k.phone_number})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-1 ml-2 flex-shrink-0",children:[e.jsx("button",{onClick:()=>x(a),className:"p-1.5 md:p-2 text-gray-400 hover:text-gray-700 dark:hover:text-gray-900 dark:text-white hover:bg-gray-100 dark:hover:bg-neutral-700 rounded-lg transition-colors",title:"View Details",children:e.jsx(ke,{className:"h-4 w-4"})}),T&&e.jsx("button",{onClick:()=>n(o,d),disabled:u,className:`p-1.5 md:p-2 rounded-lg transition-colors ${h?"bg-yellow-500/20 text-yellow-600 dark:text-yellow-500 hover:bg-yellow-500/30":"bg-blue-500/20 text-blue-600 dark:text-blue-500 hover:bg-blue-500/30"} disabled:opacity-50 disabled:cursor-not-allowed`,title:h?"Force Reconcile":"Check Status",children:e.jsx(j,{className:`h-4 w-4 ${u?"animate-spin":""}`})}),D&&e.jsx("button",{onClick:()=>r(d),disabled:u,className:`p-1.5 md:p-2 rounded-lg transition-colors ${h?"bg-yellow-500/20 text-yellow-600 dark:text-yellow-500 hover:bg-yellow-500/30":"bg-blue-500/20 text-blue-600 dark:text-blue-500 hover:bg-blue-500/30"} disabled:opacity-50 disabled:cursor-not-allowed`,title:h?"Force Reconcile":"Check Status",children:e.jsx(j,{className:`h-4 w-4 ${u?"animate-spin":""}`})})]})]}),$!==void 0&&_!==void 0&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-neutral-700",children:e.jsxs("div",{className:"flex items-center justify-between text-xs md:text-sm",children:[e.jsxs("div",{className:"truncate",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Before:"}),e.jsx("span",{className:"ml-1 text-gray-900 dark:text-gray-900 dark:text-white",children:C($,"USD")})]}),e.jsx(I,{className:"h-3 w-3 md:h-4 md:w-4 text-gray-400 dark:text-gray-500 mx-2 flex-shrink-0"}),e.jsxs("div",{className:"truncate",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"After:"}),e.jsx("span",{className:"ml-1 text-gray-900 dark:text-gray-900 dark:text-white font-semibold",children:C(_,"USD")})]})]})})]})})},$e=({isOpen:a,onClose:n,filters:r,onFilterChange:x,onReset:u})=>{const g=[{value:"all",label:"All Statuses"},{value:"pending",label:"Pending"},{value:"processing",label:"Processing"},{value:"completed",label:"Successful"},{value:"failed",label:"Failed"},{value:"cancelled",label:"Cancelled"}],w=[{value:"all",label:"All Types"},{value:"wallet_deposit",label:"Deposits"},{value:"wallet_withdrawal",label:"Withdrawals"},{value:"tournament_entry",label:"Tournament Entries"},{value:"prize_win",label:"Prize Wins"}];return a?e.jsxs("div",{className:"fixed inset-0 z-50 md:hidden",children:[e.jsx("div",{className:"fixed inset-0 bg-black/50",onClick:n}),e.jsx("div",{className:"fixed inset-y-0 right-0 w-full max-w-sm bg-white dark:bg-neutral-800 shadow-xl",children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"px-4 py-4 border-b border-gray-200 dark:border-neutral-700 flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-900 dark:text-white",children:"Filters"}),e.jsx("button",{onClick:n,className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-900 dark:text-white",children:e.jsx(fe,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto px-4 py-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Transaction Type"}),e.jsx("select",{value:r.type,onChange:o=>x("type",o.target.value),className:"w-full bg-white dark:bg-neutral-700 border border-gray-300 dark:border-neutral-600 rounded-lg px-3 py-2 text-gray-900 dark:text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:w.map(o=>e.jsx("option",{value:o.value,children:o.label},o.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Status"}),e.jsx("select",{value:r.status,onChange:o=>x("status",o.target.value),className:"w-full bg-white dark:bg-neutral-700 border border-gray-300 dark:border-neutral-600 rounded-lg px-3 py-2 text-gray-900 dark:text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:g.map(o=>e.jsx("option",{value:o.value,children:o.label},o.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Period"}),e.jsxs("select",{value:r.period,onChange:o=>x("period",o.target.value),className:"w-full bg-white dark:bg-neutral-700 border border-gray-300 dark:border-neutral-600 rounded-lg px-3 py-2 text-gray-900 dark:text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"week",children:"This Week"}),e.jsx("option",{value:"month",children:"This Month"}),e.jsx("option",{value:"year",children:"This Year"}),e.jsx("option",{value:"all",children:"All Time"})]})]}),e.jsxs("div",{className:"pt-4 border-t border-gray-200 dark:border-neutral-700",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Search Reference"}),e.jsxs("div",{className:"relative",children:[e.jsx(ve,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"text",value:r.search||"",onChange:o=>x("search",o.target.value),placeholder:"Search references...",className:"w-full bg-white dark:bg-neutral-700 border border-gray-300 dark:border-neutral-600 rounded-lg pl-10 pr-4 py-2 text-gray-900 dark:text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})]})]}),e.jsxs("div",{className:"px-4 py-4 border-t border-gray-200 dark:border-neutral-700 space-y-3",children:[e.jsx("button",{onClick:u,className:"w-full px-4 py-2.5 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-neutral-600 rounded-lg hover:bg-gray-50 dark:hover:bg-neutral-700",children:"Reset Filters"}),e.jsx("button",{onClick:n,className:"w-full px-4 py-2.5 bg-primary-600 text-gray-900 dark:text-white rounded-lg hover:bg-primary-700",children:"Apply Filters"})]})]})})]}):null},_e=({stats:a})=>{if(!a)return null;const n=[{title:"Total",value:a.total_transactions,change:a.transactions_change,icon:re,color:"bg-blue-100 dark:bg-blue-900/20",iconColor:"text-blue-600 dark:text-blue-400"},{title:"Volume",value:C(a.total_volume,"USD"),change:a.volume_change,icon:se,color:"bg-green-100 dark:bg-green-900/20",iconColor:"text-green-600 dark:text-green-400"},{title:"Pending",value:a.pending_transactions,change:null,icon:ae,color:"bg-yellow-100 dark:bg-yellow-900/20",iconColor:"text-yellow-600 dark:text-yellow-400"},{title:"Success Rate",value:`${a.success_rate}%`,change:a.success_rate_change,icon:te,color:"bg-emerald-100 dark:bg-emerald-900/20",iconColor:"text-emerald-600 dark:text-emerald-400"}];return e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-3 md:gap-4 mb-6",children:n.map((r,x)=>e.jsxs("div",{className:"bg-white dark:bg-neutral-800 rounded-xl p-3 md:p-4 border border-gray-200 dark:border-neutral-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:`p-1.5 md:p-2 rounded-lg ${r.color}`,children:e.jsx(r.icon,{className:`h-4 w-4 md:h-5 md:w-5 ${r.iconColor}`})}),r.change!==null&&e.jsxs("span",{className:`text-xs font-medium ${r.change>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:[r.change>=0?"+":"",r.change,"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg md:text-2xl font-bold text-gray-900 dark:text-gray-900 dark:text-white truncate",children:r.value}),e.jsx("p",{className:"text-xs md:text-sm text-gray-500 dark:text-gray-400 truncate",children:r.title})]})]},x))})};function Ie(){const[a,n]=l.useState([]),[r,x]=l.useState(!1),[u,g]=l.useState(""),[w,o]=l.useState(""),[d,m]=l.useState({page:1,limit:10,total:0,pages:0}),[v,N]=l.useState(null),[i,$]=l.useState(null),[_,k]=l.useState(!1),[S,h]=l.useState(!1),[T,D]=l.useState(!1),[p,P]=l.useState(new Set),[V,H]=l.useState(!1),[le,G]=l.useState(!1),[Y,B]=l.useState(!1),[b,Z]=l.useState({type:"all",status:"all",period:"month",minAmount:"",maxAmount:"",startDate:"",endDate:"",search:""}),[ne,de]=l.useState(window.innerWidth<768);l.useEffect(()=>{const t=()=>{de(window.innerWidth<768)};return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]);const F=l.useCallback(async()=>{x(!0);try{const t={page:d.page,limit:d.limit,...b};Object.keys(t).forEach(c=>{(t[c]==="all"||t[c]==="")&&delete t[c]});const s=await R.getTransactions(t);s.success?(n(s.data.transactions),m({page:s.data.page,limit:s.data.limit,total:s.data.total,pages:s.data.pages})):g(s.error||"Failed to fetch transactions")}catch(t){console.error("Fetch transactions error:",t),g(t.message||"Failed to load transactions")}finally{x(!1)}},[d.page,d.limit,b]),A=l.useCallback(async()=>{try{const t=await R.getTransactionStats({period:b.period});t.success&&N(t.data)}catch(t){console.error("Fetch stats error:",t)}},[b.period]);l.useEffect(()=>{F(),A()},[F,A]);const ie=(t,s)=>{Z(c=>({...c,[t]:s})),m(c=>({...c,page:1}))},ce=()=>{Z({type:"all",status:"all",period:"month",minAmount:"",maxAmount:"",startDate:"",endDate:"",search:""}),m(t=>({...t,page:1}))},q=async(t,s)=>{h(!0);try{const c=await R.reconcileTransaction(t);c.success?(c.reconciled?o(`Transaction ${s} reconciled successfully`):o(`Transaction ${s} status is already up to date`),F(),A()):g(c.error||"Failed to reconcile transaction")}catch(c){g(c.message||"Failed to reconcile transaction")}finally{h(!1)}},oe=async t=>{h(!0);try{(await je.cancelPendingWithdrawal(t)).success?o(`Transaction ${t} was canceled successfully `):g(`unexpected error occur while cancelling transaction ${t}`)}catch{g("unexpected error occured !, please try again later")}finally{h(!1)}},J=async()=>{if(p.size===0){g("Please select at least one transaction to reconcile");return}D(!0);try{const t=Array.from(p),s=await R.batchReconcileTransactions(t);s.success?(o(`Successfully reconciled ${s.reconciled} transaction(s)`),P(new Set),B(!1),F(),A()):g(s.error||"Failed to batch reconcile transactions")}catch(t){g(t.message||"Failed to batch reconcile transactions")}finally{D(!1)}},xe=async()=>{H(!0);try{const t={...b};Object.keys(t).forEach(z=>{(t[z]==="all"||t[z]==="")&&delete t[z]});const s=await R.exportTransactions(t),c=window.URL.createObjectURL(new Blob([s.data])),f=document.createElement("a");f.href=c,f.setAttribute("download",`transactions-${new Date().toISOString().split("T")[0]}.csv`),document.body.appendChild(f),f.click(),f.remove(),o("Transactions exported successfully")}catch{g("Failed to export transactions")}finally{H(!1)}},ge=t=>{const s=new Set(p);s.has(t)?s.delete(t):s.add(t),P(s)},me=()=>{const t=a.filter(s=>["pending","processing","initiated"].includes(s.status)).map(s=>s.id);P(new Set(t))},K=()=>{P(new Set),B(!1)},he=t=>{$(t),k(!0)},Q=l.useMemo(()=>a.filter(t=>["pending","processing","initiated"].includes(t.status)).length,[a]),ue=l.useMemo(()=>a.filter(t=>["pending","processing","initiated"].includes(t.status)&&new Date-new Date(t.created_at)>300*1e3).length,[a]),pe=()=>e.jsx("div",{className:"fixed bottom-20 right-4 z-40 md:hidden",children:e.jsxs("div",{className:"flex flex-col items-end space-y-2",children:[Y&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:K,className:"px-4 py-2 bg-gray-700 text-gray-900 dark:text-white rounded-lg shadow-lg transform transition-all duration-200 hover:scale-105",children:"Clear"}),e.jsxs("button",{onClick:J,disabled:T,className:"px-4 py-2 bg-blue-600 text-gray-900 dark:text-white rounded-lg shadow-lg transform transition-all duration-200 hover:scale-105 disabled:opacity-50",children:["Reconcile ",p.size]})]}),e.jsx("button",{onClick:()=>B(!Y),className:"p-4 bg-primary-600 text-gray-900 dark:text-white rounded-full shadow-lg transform transition-all duration-200 hover:scale-105",children:e.jsx(ye,{className:"h-6 w-6"})})]})});return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gradient-to-b dark:from-neutral-900 dark:to-neutral-800 safe-padding",children:[e.jsxs("main",{className:"mx-auto max-w-7xl py-4 md:py-8 px-3 sm:px-4 lg:px-8",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between space-y-4 md:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl md:text-3xl font-bold text-gray-900 dark:text-gray-900 dark:text-white",children:"Transactions"}),e.jsx("p",{className:"mt-1 md:mt-2 text-sm md:text-base text-gray-600 dark:text-gray-400",children:"View and manage all transactions"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>G(!0),className:"md:hidden p-2.5 bg-white dark:bg-neutral-800 border border-gray-300 dark:border-neutral-700 rounded-lg text-gray-700 dark:text-gray-300",children:e.jsx(we,{className:"h-5 w-5"})}),e.jsxs("button",{onClick:F,disabled:r,className:"inline-flex items-center px-3 md:px-4 py-2 bg-primary-600 text-gray-900 dark:text-white rounded-lg hover:bg-primary-700 transition-colors disabled:opacity-50",children:[e.jsx(j,{className:`h-4 w-4 md:h-4 md:w-4 mr-1 md:mr-2 ${r?"animate-spin":""}`}),e.jsx("span",{className:"hidden md:inline",children:"Refresh"})]}),e.jsxs("button",{onClick:xe,disabled:V||a.length===0,className:"hidden md:inline-flex items-center px-4 py-2 bg-white dark:bg-neutral-800 border border-gray-300 dark:border-neutral-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-neutral-700 transition-colors disabled:opacity-50",children:[e.jsx(I,{className:`h-4 w-4 mr-2 ${V?"animate-spin":""}`}),"Export"]})]})]})}),e.jsx(_e,{stats:v}),u&&e.jsx(X,{type:"error",title:"Error",message:u,onClose:()=>g(""),className:"mb-6"}),w&&e.jsx(X,{type:"success",title:"Success",message:w,className:"mb-6"}),p.size>0&&!ne&&e.jsx("div",{className:"mb-6 bg-gradient-to-r from-blue-500/10 to-blue-600/10 dark:from-blue-500/20 dark:to-blue-600/20 border border-blue-500/30 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-blue-500/20 rounded-lg",children:e.jsx(j,{className:"h-5 w-5 text-blue-600 dark:text-blue-500"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-900 dark:text-gray-900 dark:text-white",children:[p.size," transaction(s) selected"]}),e.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Ready for batch operations"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:K,className:"px-3 py-1.5 text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-900 dark:text-white",children:"Clear"}),e.jsxs("button",{onClick:J,disabled:T,className:"inline-flex items-center px-4 py-2 bg-blue-600 text-gray-900 dark:text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:[e.jsx(j,{className:`h-4 w-4 mr-2 ${T?"animate-spin":""}`}),"Reconcile ",p.size," Transaction(s)"]})]})]})}),e.jsxs("div",{className:"mb-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("button",{onClick:me,disabled:Q===0,className:"p-4 bg-yellow-500/10 border border-yellow-500/30 rounded-xl text-left hover:bg-yellow-500/20 transition-colors disabled:opacity-50",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ae,{className:"h-5 w-5 text-yellow-600 dark:text-yellow-500"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-gray-900 dark:text-white",children:"Select All Pending"}),e.jsxs("p",{className:"text-xs text-yellow-600 dark:text-yellow-400",children:[Q," pending"]})]})]})}),e.jsx("div",{className:"p-4 bg-red-500/10 border border-red-500/30 rounded-xl",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ee,{className:"h-5 w-5 text-red-600 dark:text-red-500"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-gray-900 dark:text-white",children:"Stuck Transactions"}),e.jsxs("p",{className:"text-xs text-red-600 dark:text-red-400",children:[ue," stuck for over 5 minutes"]})]})]})}),e.jsx("div",{className:"p-4 bg-green-500/10 border border-green-500/30 rounded-xl",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(te,{className:"h-5 w-5 text-green-600 dark:text-green-500"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-gray-900 dark:text-white",children:"Success Rate"}),e.jsxs("p",{className:"text-xs text-green-600 dark:text-green-400",children:[v?.success_rate||0,"% successful"]})]})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-neutral-800 rounded-xl border border-gray-200 dark:border-neutral-700 overflow-hidden",children:[e.jsx("div",{className:"px-4 md:px-6 py-4 border-b border-gray-200 dark:border-neutral-700",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between space-y-3 md:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-900 dark:text-white",children:"Transactions"}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Showing ",a.length," of ",d.total]})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Page ",d.page," of ",d.pages]})})]})}),r?e.jsxs("div",{className:"py-12 md:py-20 text-center",children:[e.jsx(j,{className:"h-8 w-8 animate-spin text-primary-600 dark:text-primary-500 mx-auto"}),e.jsx("p",{className:"mt-3 text-gray-600 dark:text-gray-400",children:"Loading transactions..."})]}):a.length===0?e.jsxs("div",{className:"py-12 md:py-20 text-center",children:[e.jsx(M,{className:"h-10 w-10 md:h-12 md:w-12 text-gray-400 dark:text-gray-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-900 dark:text-white mb-2",children:"No transactions found"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-500 max-w-md mx-auto px-4",children:b.status!=="all"||b.type!=="all"?"Try adjusting your filters to see more results":"No transactions available yet"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"divide-y divide-gray-200 dark:divide-neutral-700",children:a.map(t=>e.jsx(Re,{transaction:t,onReconcile:q,onCancel:oe,onViewDetails:he,isReconciling:S,isSelected:p.has(t.id),onToggleSelect:ge},t.id))}),e.jsx("div",{className:"px-4 md:px-6 py-4 border-t border-gray-200 dark:border-neutral-700",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between space-y-4 sm:space-y-0",children:[e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Showing ",(d.page-1)*d.limit+1," to"," ",Math.min(d.page*d.limit,d.total)," ","of ",d.total]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>m(t=>({...t,page:t.page-1})),disabled:d.page<=1||r,className:"px-3 py-1.5 bg-white dark:bg-neutral-700 border border-gray-300 dark:border-neutral-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-neutral-600 disabled:opacity-50",children:"Prev"}),e.jsx("div",{className:"hidden sm:flex items-center space-x-1 mx-2",children:Array.from({length:Math.min(3,d.pages)},(t,s)=>{let c;return d.pages<=3||d.page<=2?c=s+1:d.page>=d.pages-1?c=d.pages-2+s:c=d.page-1+s,e.jsx("button",{onClick:()=>m(f=>({...f,page:c})),className:`w-8 h-8 rounded-lg ${d.page===c?"bg-primary-600 text-gray-900 dark:text-white":"bg-white dark:bg-neutral-700 border border-gray-300 dark:border-neutral-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-neutral-600"}`,children:c},c)})}),e.jsx("button",{onClick:()=>m(t=>({...t,page:t.page+1})),disabled:d.page>=d.pages||r,className:"px-3 py-1.5 bg-white dark:bg-neutral-700 border border-gray-300 dark:border-neutral-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-neutral-600 disabled:opacity-50",children:"Next"})]})]})})]})]}),e.jsxs("div",{className:"mt-8 space-y-6 md:space-y-0 md:grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-neutral-800 rounded-xl p-4 md:p-6 border border-gray-200 dark:border-neutral-700",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-gray-900 dark:text-white mb-3",children:"About Transaction Reconciliation"}),e.jsxs("ul",{className:"text-sm text-gray-600 dark:text-gray-400 space-y-1.5",children:[e.jsx("li",{children:'• Use "Reconcile" to check latest status from ClickPesa'}),e.jsx("li",{children:"• Stuck transactions can be force-reconciled"}),e.jsx("li",{children:"• Batch reconcile multiple transactions at once"}),e.jsx("li",{children:"• Check gateway status for discrepancies"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-neutral-800 rounded-xl p-4 md:p-6 border border-gray-200 dark:border-neutral-700",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-gray-900 dark:text-white mb-3",children:"Common Issues & Solutions"}),e.jsxs("ul",{className:"text-sm text-gray-600 dark:text-gray-400 space-y-1.5",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Pending too long:"})," Reconcile to check status"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Status mismatch:"})," Gateway differs from local"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Missing transactions:"})," Check filters and refresh"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Balance not updated:"})," Contact support"]})]})]})]})]}),e.jsx(pe,{}),e.jsx($e,{isOpen:le,onClose:()=>G(!1),filters:b,onFilterChange:ie,onReset:ce}),_&&e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm","aria-hidden":"true"}),e.jsxs("div",{className:"relative inline-block align-bottom bg-white dark:bg-neutral-800 rounded-xl text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"px-4 md:px-6 py-4 border-b border-gray-200 dark:border-neutral-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Transaction Details"}),e.jsx("button",{onClick:()=>k(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-900 dark:text-white transition-colors",children:e.jsx(be,{className:"h-6 w-6"})})]})}),i&&e.jsxs("div",{className:"px-4 md:px-6 py-4 space-y-4",children:[e.jsxs("div",{className:"md:hidden space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`p-3 rounded-xl ${U(i.status)}`,children:e.jsx(M,{className:`h-8 w-8 ${L(i.status)}`})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(W,{type:i.type}),e.jsx(O,{status:i.status})]}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-900 dark:text-white mt-2",children:[i.amount>=0?"+":"",C(i.amount,"USD")]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"p-3 bg-gray-100 dark:bg-neutral-700/50 rounded-lg",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Reference"}),e.jsx("p",{className:"text-sm text-gray-900 dark:text-gray-900 dark:text-white font-mono truncate",children:i.order_reference})]}),e.jsxs("div",{className:"p-3 bg-gray-100 dark:bg-neutral-700/50 rounded-lg",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Date"}),e.jsx("p",{className:"text-sm text-gray-900 dark:text-gray-900 dark:text-white",children:E(i.created_at)})]})]})]}),e.jsxs("div",{className:"hidden md:block space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`p-3 rounded-xl ${U(i.status)}`,children:e.jsx(M,{className:`h-8 w-8 ${L(i.status)}`})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(W,{type:i.type}),e.jsx(O,{status:i.status})]}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-900 dark:text-white mt-2",children:[i.amount>=0?"+":"",C(i.amount,"USD")]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 bg-gray-100 dark:bg-neutral-700/50 rounded-lg",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Transaction ID"}),e.jsx("p",{className:"text-sm text-gray-900 dark:text-gray-900 dark:text-white font-mono truncate",children:i.id})]}),e.jsxs("div",{className:"p-3 bg-gray-100 dark:bg-neutral-700/50 rounded-lg",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Order Reference"}),e.jsx("p",{className:"text-sm text-gray-900 dark:text-gray-900 dark:text-white font-mono",children:i.order_reference})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 bg-gray-100 dark:bg-neutral-700/50 rounded-lg",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Created At"}),e.jsx("p",{className:"text-sm text-gray-900 dark:text-gray-900 dark:text-white",children:E(i.created_at)})]}),e.jsxs("div",{className:"p-3 bg-gray-100 dark:bg-neutral-700/50 rounded-lg",children:[e.jsx("p",{className:"text-xs text-gray500 dark:text-gray-400",children:"Updated At"}),e.jsx("p",{className:"text-sm text-gray-900 dark:text-gray-900 dark:text-white",children:E(i.updated_at)})]})]})]})]}),e.jsx("div",{className:"pt-4 border-t border-gray-200 dark:border-neutral-700",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-end space-y-2 sm:space-y-0 sm:space-x-3",children:[e.jsx("button",{onClick:()=>k(!1),className:"px-4 py-2.5 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-900 dark:text-white transition-colors",children:"Close"}),["pending","processing","initiated"].includes(i.status)&&i.type==="wallet_deposit"&&e.jsx("button",{onClick:()=>{q(i.id,i.order_reference),k(!1)},disabled:S,className:"px-4 py-2.5 bg-blue-600 text-gray-900 dark:text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:"Reconcile Now"})]})})]})]})]})})]})}export{Ie as default};
